(function(){'use strict';var g=function(a,b,c){return a.hasAttribute(b)?a.getAttribute(b):c};var h=["-ms-","-moz-","-webkit-",""],k=function(a,b,c){for(var d,e,f=0;f<h.length;++f)d=h[f]+b,e=""+c,a.style.setProperty(d,e)};var l=function(){return"ontouchstart"in window||0<window.navigator.MaxTouchPoints||0<window.navigator.msMaxTouchPoints};var m=["ICALENDAR","GOOGLE","WINDOWS_LIVE","YAHOO"],n={I:"description",J:"end-date",K:"end-time",L:"event-title",N:"location",O:"start-date",P:"start-time",R:"timezone",ICALENDAR:"icalendar",GOOGLE:"google",WINDOWS_LIVE:"windows-live",YAHOO:"yahoo",BG_COLOR:"bg-color",FONT_COLOR:"font-color",F:"font-family",G:"font-size",H:"font-weight",M:"highlight-color"},p={ICALENDAR:"gwd-icalendar-",GOOGLE:"gwd-google-calendar-",WINDOWS_LIVE:"gwd-windows-live-calendar-",YAHOO:"gwd-yahoo-calendar-"},q={ICALENDAR:"iCalendar",
GOOGLE:"Google",WINDOWS_LIVE:"Windows Live",YAHOO:"Yahoo"},r={BG_COLOR:"#fff",FONT_COLOR:"#000",Y:"0px 5px 10px rgba(0, 0, 0, 0.292969)",Z:"0px -5px 10px rgba(0, 0, 0, 0.292969)",F:"arial, helvetica, sans-serif",G:"12pt",H:"normal",ba:"hidden",M:"#e0e0e0",ea:"visible"},t={I:"description",J:"endDate",K:"endTime",L:"eventTitle",N:"location",O:"startDate",P:"startTime",R:"timezone"},u={V:"background-color",W:"border-color",X:"box-shadow",$:"color",aa:"display",F:"font-family",G:"font-size",H:"font-weight",
ca:"top",da:"visibility"};var v=function(a,b,c){if(c){var d=document.createEvent("CustomEvent");d.initCustomEvent(a,!0,!0,c)}else d=document.createEvent("Event"),d.initEvent(a,!0,!0);b.dispatchEvent(d);return d};var w=/-|:|\..*\d/g,x=/^\D|^$/,y=/\d(?=pt|px|em|%)/i,z=/8_1_3|8_2/,A=function(a,b,c,d,e){var f=(new Date).toISOString().replace(w,"");return"BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//Add To Calendar//\nBEGIN:VEVENT\nUID:"+f+"@*.2mdn.net\nDTSTAMP:"+f+"\nDTSTART:"+b+"\nDTEND:"+c+"\nSUMMARY:"+a+"\nDESCRIPTION:"+d+"\nLOCATION:"+e+"\nEND:VEVENT\nEND:VCALENDAR"},B=function(){return window.navigator.userAgent||""},C=function(a,b,c){v(b,c,{url:a}).detail.handled||window.open(a)},D=function(){var a=!l()&&-1==
B().indexOf("Chrome")&&-1!=(window.navigator.userAgent||"").indexOf("WebKit"),b=-1!=B().indexOf("iPad")&&z.test(B());return!!window.navigator.msSaveBlob||!a&&!b&&-1==B().indexOf("CriOS")},E=function(a,b){if(D()){var c=a.eventTitle;a=A(c,a.startDate,a.endDate,a.description,a.location);var d="text/calendar;charset="+document.characterSet;a=new Blob([a],{type:d});var e=c+".ics";if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(a,e);else{var f=new FileReader;f.onload=function(){var a=f.result,
b=document.createElement("a");if("download"in b){var c=new MouseEvent("click");b.href=a;b.download=e;b.type=d;b.dispatchEvent(c)}else window.location.href=a};f.readAsDataURL(a)}v("icalendar",b)}},F=function(a,b){a="&text="+a.eventTitle+"&dates="+a.startDate+"/"+a.endDate+"&details="+a.description+"&location="+a.location;C(-1==(window.navigator.userAgent||"").indexOf("WebKit")&&-1==(window.navigator.userAgent||"").indexOf("Android")||-1==B().indexOf("Mobile")||-1!=B().indexOf("iPad")?"https://www.google.com/calendar/render?action=TEMPLATE"+
a:"https://www.google.com/calendar/gpcal?#~calendar:view=e"+a,"google",b)},G=function(a,b){C("https://calendar.live.com/calendar/calendar.aspx?rru=addevent&summary="+a.eventTitle+"&dtstart="+a.startDate+"&dtend="+a.endDate+"&description="+a.description+"&location="+a.location,"windowslive",b)},H=function(a,b,c){C(b?"https://calendar.yahoo.com/?v=60&title="+a.eventTitle+"&st="+a.startDate+"&dur="+b+"&desc="+a.description+"&in_loc="+a.location:"https://calendar.yahoo.com/","yahoo",c)};function I(a,b,c,d){this.a=a;this.g=b;this.i=c;this.f=d;this.v=this.w=this.A=this.h=this.b=null;this.s=["click","touchend"];this.u=Math.random().toString(36).substring(2,6);this.b=document.createElement("div");this.h=this.C.bind(this);this.A=this.U.bind(this);this.w=this.T.bind(this);for(a=0;a<this.i.length;a++)b=this.i[a].className,D()||"gwd-icalendar-"!=b||(this.i.splice(a,1),b=this.i[a].className),c=document.createTextNode(this.i[a].text),d=document.createElement("gwd-taparea"),d.setAttribute("class",
b+this.u),d.appendChild(c),d.addEventListener("action",this.h),l()||d.addEventListener("mouseover",this.A),d.addEventListener("mouseout",this.w),this.b.appendChild(d);J(this);this.f.appendChild(this.b);this.v=this.S.bind(this);for(a=0;a<this.s.length;a++)document.body.addEventListener(this.s[a],this.v,!0)}
var K=function(a){for(var b=0;b<a.s.length;b++)document.body.removeEventListener(a.s[b],a.v,!0);for(b=a.b.firstChild;b;b=b.nextSibling)b.removeEventListener("action",a.h),b.removeEventListener("mouseover",a.A),b.removeEventListener("mouseout",a.w);a.s.length=0;a.v=null;a.h=null;a.A=null;a.w=null;a.f.removeChild(a.b);a.b=null;a.g=null;a.i=null;a.a=null},J=function(a){for(var b in u){var c=u[b];if("visibility"!=c){"background-color"==c||"border-color"==c?b="BG_COLOR":"color"==c&&(b="FONT_COLOR");var d=
g(a.f,n[b],r[b]);"font-size"==c&&(d=x.test(d)||y.test(d)?d:d+"pt");k(a.b,c,d)}}},L=function(a,b){var c=a.f.offsetHeight+a.b.offsetHeight+3;c+a.f.offsetTop>a.f.parentNode.clientHeight?(k(a.b,"top","-"+c+"px"),k(a.b,"box-shadow","0px -5px 10px rgba(0, 0, 0, 0.292969)")):(k(a.b,"box-shadow","0px 5px 10px rgba(0, 0, 0, 0.292969)"),a.b.style.removeProperty("top"));k(a.b,"visibility",b?"visible":"hidden")};I.prototype.S=function(a){"visible"==this.b.style.visibility&&(a.preventDefault(),L(this,!1))};
I.prototype.C=function(a){switch(a.target.className){case "gwd-icalendar-"+this.u:E(this.a,this.f);break;case "gwd-google-calendar-"+this.u:F(this.a,this.f);break;case "gwd-windows-live-calendar-"+this.u:G(this.a,this.f);break;case "gwd-yahoo-calendar-"+this.u:H(this.a,this.g,this.f)}};I.prototype.U=function(a){var b=g(this.f,"highlight-color","#e0e0e0");k(a.target,"background-color",b)};I.prototype.T=function(a){a.target.style.removeProperty("background-color")};var M=function(){};goog.inherits(M,HTMLElement);M.prototype.createdCallback=function(){this.c=this.g=this.B=this.a=null;this.o=this.m=this.j=this.l=!1;this.h=this.C.bind(this);this.D=document.createElement("gwd-taparea");if(0<this.childNodes.length)for(this.B=this.innerHTML;this.firstChild;)this.removeChild(this.firstChild);this.appendChild(this.D)};M.prototype.attachedCallback=function(){N(this);O(this);this.D.addEventListener("action",this.h)};
M.prototype.attributeChangedCallback=function(a){switch(a){case "description":case "event-title":case "end-date":case "end-time":case "location":case "start-date":case "start-time":case "timezone":N(this);break;case "icalendar":case "google":case "windows-live":case "yahoo":O(this);break;case "bg-color":case "font-color":case "font-family":case "font-size":case "font-weight":this.c&&J(this.c)}};
M.prototype.detachedCallback=function(){this.D.removeEventListener("action",this.h);this.c&&(K(this.c),this.c=null);P(this)};M.prototype.C=function(){if(this.a){var a=this.j&&!this.l&&!this.m&&!this.o,b=this.m&&!this.l&&!this.j&&!this.o,c=this.o&&!this.l&&!this.j&&!this.m;!this.l||this.j||this.m||this.o?a?F(this.a,this):b?G(this.a,this):c?H(this.a,this.g,this):this.c&&L(this.c,!0):E(this.a,this)}};
var P=function(a){a.g=null;a.a=null},N=function(a){a.a={};for(var b in t){var c=g(a,n[b],"");a.a[t[b]]=c}if(""==a.a.eventTitle)P(a);else if(""==a.a.endDate&&(a.a.endDate=a.a.startDate),""==a.a.endTime&&(a.a.endTime=a.a.startTime),b=new Date(a.a.startDate+" "+a.a.startTime+" "+a.a.timezone),c=new Date(a.a.endDate+" "+a.a.endTime+" "+a.a.timezone),isNaN(b)||isNaN(c))P(a);else if(b.getTime()>c.getTime())P(a);else{var d=c.getTime()-b.getTime();var e=Math.floor(d/36E5);d=(Math.floor(d/6E4)-60*e).toString();
e=e.toString();2<e.length?e=null:(2>e.length&&(e="0"+e),2>d.length&&(d="0"+d),e+=d);a.g=e;a.B&&(a.a.description=a.B);a.a.startDate=b.toISOString().replace(w,"");a.a.endDate=c.toISOString().replace(w,"");a.c&&(b=a.c,c=a.g,b.a=a.a,b.g=c)}},O=function(a){var b=0;a.l=a.hasAttribute("icalendar");a.l&&b++;a.j=a.hasAttribute("google");a.j&&b++;a.m=a.hasAttribute("windows-live");a.m&&b++;a.o=a.hasAttribute("yahoo");a.o&&b++;a.c&&(K(a.c),a.c=null);if(1<b){b=[];for(var c=0;c<m.length;c++){var d=m[c];if(a.hasAttribute(n[d])){var e=
{};e.className=p[d];e.text=q[d];b.push(e)}}0!=b.length&&(a.c=new I(a.a,a.g,b,a))}};document.registerElement("gwd-addtocalendar",{prototype:M.prototype});}).call(this);
